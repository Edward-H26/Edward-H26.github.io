---
name: Illinois State Buildings Analysis
tools: [Python, Altair, vega-lite, Pandas]
image: assets/pngs/buildings.png
description: Interactive analysis of Illinois state building inventory with temporal-size patterns and usage distribution across counties
custom_js:
  - vega.min
  - vega-lite.min
  - vega-embed.min
  - justcharts
---

# Illinois State Buildings Interactive Analysis

## The Comprehensive Analysis of Illinois State Buildings Based on the Year Constructed and Square Footage by Category Distribution

<vegachart schema-url="{{ site.baseurl }}/assets/json/buildingAgeAndSizeAnalysis.json" style="width: 100%"></vegachart>

### Summary

#### Description
This visualization presents a comprehensive analysis of Illinois state buildings through `buildingAgeAndSizeAnalysis` that consists of`buildingYearAndAreaScatterPlot` and `agencyCategoryHistogramPlot`.  By plotting `Year Constructed` against `Square Footage` on a `log` scale, the scatter plot highlights patterns over time and differences in building size. Each point represents an individual building from the `buildingDatasetCleaned` dataframe, which contains filtered records without any missing data in `Year Constructed`, `Year Acquired`, and `Square Footage` by applying `Year Constructed > 0`, `Year Acquired > 0`, and `Square Footage > 0` to the preprocessed dataframe. The visualization incorporates the custom `Agency Category` field that is created from the `agencyCategories` through unique mapping strategy, which combines 38 distinct agency names from `buildingDatasetRaw["Agency Name"].unique()` into 10 general categories. The histogram displays the count distribution across these agency categories, which dynamically updates based on the brush selection from the scatter plot. The visualization uses the pipe operator (`|`) to create a side by side layout with widths of 300 pixels each in order to create a holistic view of the dataset. 

#### Encodings
The scatter plot `buildingYearAndAreaScatterPlot` utilizes carefully chosen encodings to effectively represent the multidimensional building data. The x-axis utilizes `alt.X("Year Constructed:Q")` with the descriptive title "The Year of the Building Being Constructed" and implements a scale domain of `[1700, 2025]` to accommodate both historical buildings dating back to Illinois' early statehood and provide space for contemporary constructions. The y-axis encoding `alt.Y("Square Footage:Q")` with the title "The Area of the Building in Square Footage" incorporates a logarithmic scale through `scale = alt.Scale(type = "log")`, which elegantly compresses the vast range of building sizes from small utility structures to massive institutional facilities into a visually interpretable format. The `mark_circle()` function generates circular marks with `size = 40` to ensure visibility across the plot while `opacity = 0.6` allows overlapping points to create natural density patterns without completely obscuring underlying data. The comprehensive tooltip configuration includes nine essential fields: `Location Name:N`, `Agency Name:N`, `Agency Category:N`, `City:N`, `Year Constructed:Q`, `Square Footage:Q` formatted with comma separators, `Total Floors:Q`, `Usage Description:N`, and `Bldg Status:N`, providing users with detailed contextual information during exploration.

The histogram `agencyCategoryHistogramPlot` employs `mark_bar()` with `alt.X("Agency Category:N")` on the horizontal axis, incorporating `axis = alt.Axis(labelAngle = -45)` to ensure category names remain readable despite their length. The vertical axis uses `alt.Y("count():Q")` with the title "The Number of Buildings" to display the frequency distribution across categories through Altair's built-in count aggregation. Both visualizations maintain consistent dimensions at 400x400 pixels and utilize `anchor = "middle"` for title alignment, creating visual harmony in the combined display.

#### Colormaps
The color strategy implements `alt.Color("Agency Category:N")` with `scale = alt.Scale(scheme = "category10")` consistently across both visualizations, establishing visual coherence throughout the interactive experience. The `category10` palette was deliberately selected because it provides exactly 10 distinct, perceptually balanced colors that align perfectly with the 10 agency categories defined in the `agencyCategories` dictionary, including Higher Education, Corrections & Justice, Health & Human Services, and Infrastructure & Operations. This categorical scheme ensures that each agency type receives equal visual prominence without implying any hierarchical relationships, which is crucial for objective analysis of state resources. The scatter plot's 0.6 opacity setting allows these colors to blend naturally where points overlap, creating organic density visualizations that reveal concentration patterns while maintaining the ability to identify individual buildings. In the histogram, the legend is intentionally suppressed through `legend = None` to eliminate redundancy, as the x-axis labels already provide category identification and the color serves primarily to maintain visual continuity with the scatter plot selections rather than convey additional information.

#### Transformations
The data undergoes systematic transformation to prepare it for meaningful visualization, beginning with the sophisticated categorization system implemented through the `agencyCategories` dictionary. This mapping transforms 38 unique values from `buildingDatasetRaw["Agency Name"]` into 10 logically grouped categories that reflect the functional organization of state government, such as consolidating all state universities under "Higher Education" and grouping related law enforcement agencies under "Public Safety & Emergency". The transformation is applied through `buildingDatasetRaw["Agency Category"] = buildingDatasetRaw["Agency Name"].map(agencyCategories)`, creating a new analytical dimension that enables pattern recognition across related agencies. 

The data cleaning process implemented through `buildingDatasetCleaned = buildingDatasetRaw[(buildingDatasetRaw["Year Constructed"] > 0) & (buildingDatasetRaw["Year Acquired"] > 0) & (buildingDatasetRaw["Square Footage"] > 0)]` removes records with zero or negative values that represent data entry errors or missing information, ensuring the integrity of the visualization. The logarithmic transformation applied to the Square Footage axis through `scale = alt.Scale(type = "log")` mathematically converts the data to reveal patterns across multiple orders of magnitude, making it possible to simultaneously visualize small administrative offices and massive institutional complexes on the same plot. The brush selection mechanism creates a dynamic transformation through `transform_filter(brushSelection)` that filters the histogram data in real-time based on the user's selection area, while the count aggregation continuously recalculates category frequencies to reflect only the selected subset of buildings.

#### Interactivity
The interval brush selection implemented through `brushSelection = alt.selection_interval(encodings = ["x", "y"])` transforms the visualization from a static display into a powerful analytical tool that responds to user exploration. By enabling click-and-drag selection across both temporal and spatial dimensions simultaneously, users can investigate specific hypotheses about state building patterns, such as examining what types of agencies constructed large facilities during particular historical periods. The selection is integrated into the scatter plot via `.add_params(brushSelection)` and connected to the histogram through `.transform_filter(brushSelection)`, creating a responsive analytical environment where the categorical distribution instantly updates to reflect the selected subset of buildings.

The comprehensive nine-field tooltip system provides detailed information on demand without cluttering the visual display, revealing building-specific details including exact locations, managing agencies, construction dates, and current status whenever users hover over individual points. The formatted Square Footage values using `format = ","` ensure that large numbers remain readable (displaying "1,234,567" rather than "1234567"), enhancing the user experience during detailed exploration. The 0.6 opacity setting ensures that brush selections remain visible even in densely populated regions of the plot, while the logarithmic scale maintains consistent interactivity across the entire range of building sizes, from the smallest to the largest facilities in the state inventory.

## The Comprehensive Analysis of Illinois State Buildings Based on the Building Usage Types and Location by County Distribution

<vegachart schema-url="{{ site.baseurl }}/assets/json/buildingUsageTypeAndLocationAnalysis.json" style="width: 100%"></vegachart>

### Write Up

#### Description
This visualization combines `usageTypeBarChart` and `countyDistributionBarChart` into `buildingUsageTypeAndLocationAnalysis`, creating an interactive exploration tool for understanding both functional usage patterns and geographic distribution of Illinois state buildings. The left chart displays all unique values from `buildingDatasetCleaned["Usage Description"]` as horizontal bars sorted by frequency, revealing the variety of purposes these state facilities serve across Illinois. The right chart presents the geographic distribution across the state's most significant counties, determined through `buildingDatasetCleaned["County"].value_counts().head(20).index.tolist()` which identifies the top 20 counties by building count and stores them in the `topCounties` list. This subset is then used to create `topCountyBuildings = buildingDatasetCleaned[buildingDatasetCleaned["County"].isin(topCounties)]`, ensuring the geographic visualization remains interpretable while capturing the vast majority of state building infrastructure. The visualization leverages `clickSelection = alt.selection_point(fields = ["Usage Description"])` to establish an interactive connection between building purposes and their geographic patterns, enabling users to explore questions about whether certain types of facilities cluster in specific regions or distribute evenly across the state. Through the pipe operator (`|`) layout with the usage chart at 300 pixels width and the county chart at 350 pixels width, the combined visualization provides complementary perspectives on the state's building infrastructure.

#### Encodings
The `usageTypeBarChart` implements a horizontal bar design with `alt.X("count():Q", title = "Number of Buildings")` representing the quantitative frequency of each usage type and `alt.Y("Usage Description:N", title = "Usage Type", sort = "-x")` displaying the categorical usage descriptions in descending order of frequency, ensuring the most common building types appear prominently at the top. The conditional color encoding `alt.condition(clickSelection, alt.Color("Usage Description:N", scale = alt.Scale(scheme = "category20"), legend = None), alt.value("lightgray"))` creates a dynamic visual response where selected usage types display in distinctive colors from the category20 palette while unselected types recede into a neutral gray background. This visual hierarchy is reinforced through the opacity encoding `alt.condition(clickSelection, alt.value(1.0), alt.value(0.3))`, which applies full opacity to selected items and reduces unselected items to 30% opacity, creating a spotlight effect that guides user attention.

The `countyDistributionBarChart` employs a similar horizontal structure with `alt.X("count():Q", title = "Number of Buildings")` for the building count and `alt.Y("County:N", title = "County (Top 20)", sort = "-x")` for county names, maintaining the intuitive descending frequency arrangement. The deliberate use of a static color `alt.value("steelblue")` provides visual stability and professional appearance while avoiding color competition with the usage type selections. Both charts incorporate formatted tooltips through `alt.Tooltip("count():Q", title = "Number of Buildings", format = ",")`, ensuring that precise counts display with thousand separators for improved readability when users seek specific numerical values.

#### Colormaps
The visualization implements a sophisticated dual-strategy color system that balances categorical distinction with visual clarity. The `usageTypeBarChart` utilizes the expansive `category20` color scheme, which provides 20 distinct colors to accommodate the diverse array of usage types revealed by `buildingDatasetCleaned["Usage Description"].unique()`, including offices, laboratories, storage facilities, warehouses, classrooms, dormitories, and various specialized facilities unique to state operations. This extended palette ensures that each usage type receives a visually distinct color when selected, facilitating clear identification and comparison across selections. The unselected state employs `lightgray` (#D3D3D3), a carefully chosen neutral tone that maintains visibility while clearly indicating inactive status, creating an effective visual hierarchy that doesn't overwhelm users with excessive color information when exploring individual usage types.

The `countyDistributionBarChart` deliberately adopts a monochromatic approach using `steelblue` (#4682B4), a design decision that reflects the fundamental difference between categorical usage types and geographic counties. This single-color strategy prevents visual confusion between the two chart types while emphasizing that counties represent spatial rather than categorical distinctions. The steelblue selection provides professional aesthetics with sufficient contrast against the white background, ensuring readability across all screen types. By maintaining constant color regardless of selection state and relying on data filtering rather than color changes to indicate connections, the visualization creates a clear mental model where multicolor represents functional categories and monochrome represents geographic distribution, helping users maintain orientation during their analytical exploration.

#### Transformations
The geographic data undergoes strategic transformation to balance comprehensive coverage with visual clarity through the creation of the `topCounties` subset. The operation `buildingDatasetCleaned["County"].value_counts().head(20).index.tolist()` performs a sophisticated multi-step transformation: first counting the frequency of buildings in each county, then sorting these counts in descending order, selecting the top 20 counties, and finally extracting just the county names as a Python list. This list subsequently filters the full dataset through `topCountyBuildings = buildingDatasetCleaned[buildingDatasetCleaned["County"].isin(topCounties)]`, reducing Illinois' 102 counties to the 20 most significant by building count, which analysis shows captures the overwhelming majority of state building infrastructure while maintaining chart readability.

The click selection mechanism creates dynamic data transformation through `.transform_filter(clickSelection)` applied to the county distribution chart. When users click a usage type bar, this transformation immediately filters the `topCountyBuildings` dataset to include only buildings matching the selected `Usage Description` value, triggering a cascade of recalculations where the count aggregation `count():Q` recomputes building frequencies for each county based solely on the selected usage type. The consistent `-x` sort transformation in both charts ensures that bars always display in frequency order rather than alphabetical order, facilitating pattern recognition and making it easy to identify both the most common usage types and the counties with the highest concentrations of specific building types. The `.add_params(clickSelection)` transformation on the usage chart establishes it as the control element for the interactive system, creating a unidirectional data flow where user interactions trigger filtered transformations that propagate to the geographic display.

#### Interactivity
The point selection mechanism implemented through `clickSelection = alt.selection_point(fields = ["Usage Description"])` creates an intuitive exploratory interface that transforms static charts into a dynamic analytical system. When users click any bar in the `usageTypeBarChart`, the interaction triggers a coordinated visual response: the selected usage type transitions from subdued light gray to its assigned vibrant color from the category20 palette, its opacity increases from 30% to 100% creating a clear focal point, all other usage types simultaneously dim to maintain context while yielding visual prominence, and the `countyDistributionBarChart` instantly updates through `transform_filter(clickSelection)` to display only buildings of the selected type across the top 20 counties.

This interactive design enables sophisticated comparative analysis workflows that would be impossible with static visualizations. Users can systematically click through different usage types to compare their geographic patterns â€“ for instance, selecting "Laboratory" immediately reveals concentration in counties hosting major research universities like Champaign County (UIUC) and Jackson County (SIU), while selecting "Office" shows entirely different patterns with concentrations in Sangamon County (Springfield's state government complex) and Cook County (Chicago's administrative centers). The persistent selection state allows users to study filtered distributions without maintaining mouse position or click pressure, while the tooltip functionality provides precise numerical counts when visual bar lengths are too similar for accurate comparison. The carefully chosen widths of 300 and 350 pixels optimize the side-by-side layout for standard displays while ensuring all labels remain readable, and the selection binding to the entire bar area rather than just the colored portion improves usability by providing a larger click target.

## Data & Methods

The analysis uses the Illinois state building inventory dataset from `https://raw.githubusercontent.com/UIUC-iSchool-DataViz/is445_data/main/building_inventory.csv`, loaded via `pd.read_csv(datasetUrl)` into `buildingDatasetRaw`. The dataset contains comprehensive records with columns identified through `buildingDatasetRaw.columns`, including Square Footage, Year Constructed, Year Acquired, Agency Name, Usage Description, County, City, Total Floors, and Building Status. 

Data quality assessment using `buildingDatasetRaw.isna().sum()` revealed missing values, leading to the filtering operation that created `buildingDatasetCleaned`. The `numericFeatures` and `categoricalFeatures` were identified using `select_dtypes()` to understand data types for appropriate encoding choices. The custom `agencyCategories` dictionary consolidated 38 agencies into 10 categories, applied via the `.map()` function. 

Visualizations use `alt.data_transformers.enable("default", max_rows = None)` to handle the full dataset. The final specifications are saved as Vega-Lite JSON using `.save("../assets/json/buildingAgeAndSizeAnalysis.json")` and `.save('../assets/json/buildingUsageTypeAndLocationAnalysis.json')` for web deployment.

<div class="left">
{% include elements/button.html link="https://raw.githubusercontent.com/UIUC-iSchool-DataViz/is445_data/main/building_inventory.csv" text="The Data" %}
</div>

<div class="right">
{% include elements/button.html link="https://github.com/Edward-H26/Edward-H26.github.io/blob/main/python_notebooks/Building_inventory_project.ipynb" text="The Analysis" %}
</div>